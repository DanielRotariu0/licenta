{"ast":null,"code":"import { LOCALE_ID, ElementRef } from \"@angular/core\";\nimport { ConfirmationService } from \"primeng/api\";\nimport { first } from \"rxjs/operators\";\nimport { formatDate } from \"@angular/common\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services\";\nimport * as i2 from \"primeng/api\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"primeng/inputtextarea\";\nimport * as i6 from \"primeng/button\";\nimport * as i7 from \"primeng/fieldset\";\nimport * as i8 from \"primeng/confirmdialog\";\nimport * as i9 from \"../job-details/job-details.component\";\nconst _c0 = [\"scrollMe\"];\n\nfunction JobApplicationDetailsComponent_p_button_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"p-button\", 11);\n    i0.ɵɵlistener(\"click\", function JobApplicationDetailsComponent_p_button_7_Template_p_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.onClickWithdraw());\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction JobApplicationDetailsComponent_li_16_strong_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"strong\");\n    i0.ɵɵtext(1, \" You,\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction JobApplicationDetailsComponent_li_16_strong_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"strong\");\n    i0.ɵɵtext(1, \" Recruiter,\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction JobApplicationDetailsComponent_li_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtemplate(1, JobApplicationDetailsComponent_li_16_strong_1_Template, 2, 0, \"strong\", 12);\n    i0.ɵɵtemplate(2, JobApplicationDetailsComponent_li_16_strong_2_Template, 2, 0, \"strong\", 12);\n    i0.ɵɵtext(3);\n    i0.ɵɵelement(4, \"br\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const message_r5 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.user.id == message_r5.userId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.user.id != message_r5.userId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", message_r5.formattedTimestamp, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", message_r5.content, \" \");\n  }\n}\n\nconst _c1 = function () {\n  return {\n    width: \"25vw\"\n  };\n};\n\nexport let JobApplicationDetailsComponent = /*#__PURE__*/(() => {\n  class JobApplicationDetailsComponent {\n    constructor(accountService, jobApplicationService, messageService, confirmationService, locale) {\n      this.accountService = accountService;\n      this.jobApplicationService = jobApplicationService;\n      this.messageService = messageService;\n      this.confirmationService = confirmationService;\n      this.locale = locale;\n      this.textareaValue = \"\";\n      this.accountService.user.subscribe(x => this.user = x);\n    }\n\n    ngOnInit() {\n      this.jobApplication.messageList.map(message => message.formattedTimestamp = formatDate(message.timestamp, \"d MMM y, h:mm:ss a\", this.locale));\n      this.scrollToBottom();\n    }\n\n    sendMessage() {\n      let content = this.textareaValue.trim();\n\n      if (content !== \"\") {\n        this.jobApplicationService.addMessage(this.jobApplication.id, {\n          userId: this.user.id,\n          content: content\n        }).pipe(first()).subscribe({\n          next: message => {\n            message.formattedTimestamp = formatDate(message.timestamp, \"d MMM y, h:mm:ss a\", this.locale);\n            this.jobApplication.messageList.push(message);\n            this.scrollToBottom();\n            this.textareaValue = \"\";\n          },\n          error: error => {\n            console.log(\"error\");\n          }\n        });\n      }\n    }\n\n    onClickWithdraw() {\n      this.confirmationService.confirm({\n        message: \"Do you want to withdraw this job application?\",\n        header: \"Withdraw Confirmation\",\n        icon: \"pi pi-info-circle\",\n        accept: () => {\n          this.jobApplicationService.update(this.jobApplication.id, 8).pipe(first()).subscribe({\n            next: () => {\n              this.jobApplication.status.name = \"WITHDRAWN\";\n              this.messageService.add({\n                severity: \"success\",\n                summary: \"Success\",\n                detail: \"You have withdrawn your job application\"\n              });\n            },\n            error: error => {\n              this.messageService.add({\n                severity: \"error\",\n                summary: \"Error\",\n                detail: \"An error has occured\"\n              });\n            }\n          });\n        }\n      });\n    }\n\n    scrollToBottom() {\n      try {\n        this.myScrollContainer.nativeElement.scroll({\n          top: this.myScrollContainer.nativeElement.scrollHeight + 100,\n          left: 0\n        });\n      } catch (err) {}\n    }\n\n  }\n\n  JobApplicationDetailsComponent.ɵfac = function JobApplicationDetailsComponent_Factory(t) {\n    return new (t || JobApplicationDetailsComponent)(i0.ɵɵdirectiveInject(i1.AccountService), i0.ɵɵdirectiveInject(i1.JobApplicationService), i0.ɵɵdirectiveInject(i2.MessageService), i0.ɵɵdirectiveInject(i2.ConfirmationService), i0.ɵɵdirectiveInject(LOCALE_ID));\n  };\n\n  JobApplicationDetailsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: JobApplicationDetailsComponent,\n    selectors: [[\"app-job-application-details\"]],\n    viewQuery: function JobApplicationDetailsComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.myScrollContainer = _t.first);\n      }\n    },\n    inputs: {\n      jobApplication: \"jobApplication\"\n    },\n    features: [i0.ɵɵProvidersFeature([ConfirmationService])],\n    decls: 20,\n    vars: 11,\n    consts: [[\"legend\", \"Job details\", \"collapsed\", \"true\", 3, \"toggleable\"], [3, \"job\"], [3, \"baseZIndex\"], [\"icon\", \"pi pi-times\", \"label\", \"Withdraw\", 3, \"click\", 4, \"ngIf\"], [1, \"chat-box\"], [1, \"header\"], [1, \"message-box\"], [\"scrollMe\", \"\"], [4, \"ngFor\", \"ngForOf\"], [\"pInputTextarea\", \"\", \"placeholder\", \"write a message\", 3, \"ngModel\", \"ngModelChange\"], [\"label\", \"Send\", 3, \"click\"], [\"icon\", \"pi pi-times\", \"label\", \"Withdraw\", 3, \"click\"], [4, \"ngIf\"]],\n    template: function JobApplicationDetailsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"p-fieldset\", 0);\n        i0.ɵɵelement(1, \"app-job-details\", 1);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"h4\");\n        i0.ɵɵtext(3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"h4\");\n        i0.ɵɵtext(5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(6, \"p-confirmDialog\", 2);\n        i0.ɵɵtemplate(7, JobApplicationDetailsComponent_p_button_7_Template, 1, 0, \"p-button\", 3);\n        i0.ɵɵelement(8, \"br\")(9, \"br\");\n        i0.ɵɵelementStart(10, \"div\", 4)(11, \"div\", 5)(12, \"h4\");\n        i0.ɵɵtext(13, \"\\u00A0 Messages\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"div\", 6, 7);\n        i0.ɵɵtemplate(16, JobApplicationDetailsComponent_li_16_Template, 6, 4, \"li\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"section\")(18, \"textarea\", 9);\n        i0.ɵɵlistener(\"ngModelChange\", function JobApplicationDetailsComponent_Template_textarea_ngModelChange_18_listener($event) {\n          return ctx.textareaValue = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"p-button\", 10);\n        i0.ɵɵlistener(\"click\", function JobApplicationDetailsComponent_Template_p_button_click_19_listener() {\n          return ctx.sendMessage();\n        });\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"toggleable\", true);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"job\", ctx.jobApplication == null ? null : ctx.jobApplication.jobDetails);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"Last updated on \", ctx.jobApplication == null ? null : ctx.jobApplication.formattedUpdatedAt, \"\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"Current Status: \", ctx.jobApplication == null ? null : ctx.jobApplication.status == null ? null : ctx.jobApplication.status.name, \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵstyleMap(i0.ɵɵpureFunction0(10, _c1));\n        i0.ɵɵproperty(\"baseZIndex\", 10000);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", (ctx.jobApplication == null ? null : ctx.jobApplication.status == null ? null : ctx.jobApplication.status.name) != \"WITHDRAWN\");\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngForOf\", ctx.jobApplication.messageList);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.textareaValue);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgModel, i5.InputTextarea, i6.Button, i7.Fieldset, i8.ConfirmDialog, i9.JobDetailsComponent],\n    styles: [\".chat-box[_ngcontent-%COMP%]{margin:0 auto;height:600px;border-radius:10px;border:2px solid rgb(130,125,125);box-sizing:border-box;display:flex;flex-direction:column;justify-content:space-between;overflow:hidden}textarea[_ngcontent-%COMP%]::placeholder{font-size:16px;opacity:.7}.header[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:none;justify-content:space-between;background-color:#7d7878;margin:10;width:101%;margin-left:-2px;box-sizing:border-box;z-index:2}.message-box[_ngcontent-%COMP%]{padding:10px;box-sizing:border-box;background-color:transparent;height:100%;overflow:scroll;display:flex;flex-direction:column;justify-content:flex-start}textarea[_ngcontent-%COMP%]{width:70%;height:100px;resize:none}section[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:none;justify-content:space-between;margin-bottom:10px;padding:10px;box-sizing:border-box}li[_ngcontent-%COMP%]{list-style-type:none;padding:10px;border-bottom:1px solid rgba(209,201,201,.7);font-size:18px}\"]\n  });\n  return JobApplicationDetailsComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}